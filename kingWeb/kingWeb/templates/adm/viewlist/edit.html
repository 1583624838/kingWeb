{% extends "adm/shared/layout_content.html" %}
{%block title%}{{title}}{% endblock%}

{% block scripts %}
    <script type="text/javascript">
        $(function () {
            lkWeb.FormValidation($("#lkForm"), function () {
                //lkWeb.GoAction("adm", "viewlist", "index", "{{tableid}}")
                lkWeb.RefreshAndClose()
            }, "操作成功")
        })

    </script>
{% endblock %}


{% block content %}
<form class="form-horizontal" action="/adm/viewlist/post_edit/{{id}}/{{tableid}}/" method="post" id="lkForm">
    {%csrf_token%}
    {% load set_val %}
    {% load filters %}
       {% for col in tablecolumns%}
            {% if col.datatype == 'out' %}
                <div class="form-group">

                        <label class="col-md-2 control-label">{{col.description}}</label>
                        <div class="col-md-9">
                            <select name="{{col.name}}" class="form-control">
                                    {% for key,value in out_col_data.items %}
                                        {% if key == col.name%}
                                            {% for item in value%}
                                                  <option value="{{item.value}}"
                                                          {% for k,v in data.items %}
                                                                {% if k == col.name %}
                                                                     {% if v == item.value%}
                                                                          selected
                                                                    {% endif %}
                                                                {% endif %}
                                                          {% endfor %}
                                                   >{{item.text}}</option>
                                            {% endfor %}
                                        {% endif %}
                                    {% endfor %}
                            </select>
                        </div>

                </div>
           {% elif col.datatype == 'enum' %}
                   <div class="form-group">
                            <label class="col-md-2 control-label">{{col.description}}</label>
                            <div class="col-md-9">
                              <select name="{{col.name}}" class="form-control">
                                  {% for key,value in enum_col_data.items %}
                                        {% if key == col.name%}
                                            {% for item in value%}
                                                  <option value="{{item}}"
                                                      {% for k,v in data.items %}
                                                                {% if k == col.name %}
                                                                    {% if v == item%}
                                                                          selected
                                                                    {% endif %}
                                                                {% endif %}
                                                          {% endfor %}
                                                          >{{item}}</option>
                                            {% endfor %}
                                        {% endif %}
                                    {% endfor %}
                               </select>
                            </div>
                    </div>
           {% else %}
                <div class="form-group">
                        <label class="col-md-2 control-label">{{col.description}}</label>
                        <div class="col-md-9">
                            <input type="text" class="form-control" name="{{col.name}}"  data-val="true" value="{{data|get_value:col.name}}"
                                   {% ifequal col.required 1%} data-val-required="{{col.name}}不能为空"{% endifequal %}
                             {% ifnotequal col.required 0%}
                               data-val-maxlength="{{col.description}}长度不能超过{{col.maxlength}}个字符"
                                   data-val-maxlength-max="{{col.maxlength}}"/>{% endifnotequal %}
                            <span class="field-validation-valid" data-valmsg-for="{1}" data-valmsg-replace="true"></span>
                        </div>
                    </div>
            {% endif %}
       {% endfor %}

    <div class="form-group">
        <div class="col-md-3 col-md-offset-3">
            <button type="submit" class="btn btn-success">确定</button>
            <button type="button" class="btn btn-default" onclick="lkWeb.RefreshAndClose()">返回</button>
        </div>
    </div>
</form>
{% endblock %}